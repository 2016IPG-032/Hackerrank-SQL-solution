select ch.hacker_id,hack.name,count(distinct ch.challenge_id) from challenges ch join hackers hack on ch.hacker_id=hack.hacker_id group by ch.hacker_id,name having not exists ( select * from challenges ch2, (select count(distinct challenge_id) as nums from challenges group by hacker_id) P where ch2.hacker_id <> ch.hacker_id group by hacker_id having count(distinct ch2.challenge_id) = count(distinct ch.challenge_id) and count(distinct ch.challenge_id) < max(p.nums)) order by count(distinct ch.challenge_id) desc, ch.hacker_id asc;
